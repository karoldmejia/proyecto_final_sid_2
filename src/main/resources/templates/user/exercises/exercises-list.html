<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      th:replace="~{layouts/baseUser :: layout}">
<head>

</head>
<body>

<div th:fragment="content">

    <link rel="icon" th:href="@{/images/logo/icesifit_logo_negro.svg}" media="(prefers-color-scheme: light)">
    <link rel="icon" th:href="@{/images/logo/icesifit_logo_blanco.svg}" media="(prefers-color-scheme: dark)">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/main.css}">
    <link rel="stylesheet" th:href="@{/css/components/header_user_mngmt.css}">
    <link rel="stylesheet" th:href="@{/css/users/personas.css}">
    <link rel="stylesheet" th:href="@{/styles.css}">

    <div class="header-actions">
        <h1 class="text-2xl font-bold">
            Lista de Ejercicios
        </h1>


    </div>
    <table>
        <thead>
        <tr>
            <th>Nombre</th>
            <th>Tipo</th>
            <th>Dificultad</th>
            <th>Duración</th>

        </tr>
        </thead>
        <tbody>
        <tr th:each="exercise : ${exercises}">
            <td th:text="${exercise.name}">Press de Banca</td>
            <td th:text="${exercise.type}">Fuerza</td>
            <td th:text="${exercise.difficulty}">Intermedio</td>
            <td th:text="|${exercise.duration} min|">10 min</td>


        </tr>

        <tr th:if="${#lists.isEmpty(exercises)}">
            <td colspan="5" style="text-align: center;">No hay ejercicios para mostrar.</td>
        </tr>
        </tbody>
    </table>

    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">
                <span class="material-icons-round">close</span>
            </button>
            <div id="modal-body"></div>
        </div>
    </div>
    <script>
        // (Script del menú desplegable sin cambios)
        function toggleMenu(button) {
            button.closest('.action-cell').classList.toggle('show-menu');
        }
        document.addEventListener('click', function(event) {
            document.querySelectorAll('.action-cell.show-menu').forEach(cell => {
                if (!cell.contains(event.target)) {
                    cell.classList.remove('show-menu');
                }
            });
        });

        // ===== CAMBIO 4: Script del Modal añadido =====
        async function openModal(url) {
            const overlay = document.getElementById('modal-overlay');
            const body = document.getElementById('modal-body');

            body.innerHTML = '<p class="text-center text-gray-500">Cargando...</p>';
            overlay.classList.remove('hidden');

            try {
                const response = await fetch(url);
                const html = await response.text();
                body.innerHTML = html;
            } catch (err) {
                body.innerHTML = '<p class="text-center text-red-500">Error al cargar el contenido.</p>';
            }
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.add('hidden');
            document.getElementById('modal-body').innerHTML = '';
        }

        // Cerrar modal si se hace clic fuera del contenido
        document.addEventListener('click', (e) => {
            if (e.target.id === 'modal-overlay') closeModal();
        });
        // =============================================
    </script>
</div>
</body>
</html>